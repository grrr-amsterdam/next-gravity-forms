"use strict";var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(exports,"__esModule",{value:!0}),exports["default"]=void 0;var _regenerator=_interopRequireDefault(require("@babel/runtime/regenerator")),_asyncToGenerator2=_interopRequireDefault(require("@babel/runtime/helpers/asyncToGenerator")),_isomorphicUnfetch=_interopRequireDefault(require("isomorphic-unfetch")),_index=require("./index");function onSubmit(){return _onSubmit.apply(this,arguments)}function _onSubmit(){return _onSubmit=(0,_asyncToGenerator2["default"])(_regenerator["default"].mark(function n(a,b,c,d,e,f,g,h,i,j,k,l,m){var o,p,q,r,s,t,u,v,w;return _regenerator["default"].wrap(function(g){for(;;)switch(g.prev=g.next){case 0:if(o=b.onSubmit,p=new FormData(a.target),a.preventDefault(),q=(0,_index.forceValidation)(d,c,j,k),q){g.next=6;break}return g.abrupt("return",!1);case 6:o?o(p):(f(!0),h(!1),i(!1),l(!1),m(!1),r=b.formID,s=b.backendUrl,t=b.jumpToConfirmation,u=b.onSubmitSuccess,v=b.onError,w=s.substring(0,s.indexOf("/wp-json")),(0,_isomorphicUnfetch["default"])("".concat(w,"/wp-json/gf/v2/forms/").concat(r,"/submissions"),{method:"POST",body:p}).then(function(a){return a.json()}).then(function(a){if(a&&a.is_valid){if(u){var c=u(a);if(!c)return!1}var d=a.confirmation_message,g=d||!1,i=g.type,j=g.link;if(i&&j&&"redirect"===i&&"undefined"!=typeof window)return window.location.replace(j),!1;f(!1),h(!0),l(d),t&&(0,_index.scrollToConfirmation)(b,e)}else throw{response:a}})["catch"](function(a){var c=a&&a.response&&a.response.validation_messages?a.response.validation_messages:"Something went wrong";v?(v(c),f(!1),i(!0)):(f(!1),i(!0),m(c)),t&&(0,_index.scrollToConfirmation)(b,e)}));case 7:case"end":return g.stop();}},n)})),_onSubmit.apply(this,arguments)}var _default=onSubmit;exports["default"]=_default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJvblN1Ym1pdCIsImV2ZW50IiwicHJvcHMiLCJmb3JtVmFsdWVzIiwiYWN0aXZlUGFnZSIsIndyYXBwZXJSZWYiLCJzZXRTdWJtaXR0aW5nIiwic3VibWl0U3VjY2VzcyIsInNldFN1Ym1pdFN1Y2Nlc3MiLCJzZXRTdWJtaXRGYWlsZWQiLCJzZXRTaG93UGFnZVZhbGlkYXRpb25Nc2ciLCJzZXRUb3VjaGVkIiwic2V0Q29uZmlybWF0aW9uTWVzc2FnZSIsInNldEVycm9yTWVzc2FnZXMiLCJjdXN0b21PblN1Ym1pdCIsImZvcm1EYXRhIiwiRm9ybURhdGEiLCJ0YXJnZXQiLCJwcmV2ZW50RGVmYXVsdCIsImlzUGFnZVZhbGlkIiwiZm9yY2VWYWxpZGF0aW9uIiwiZm9ybUlEIiwiYmFja2VuZFVybCIsImp1bXBUb0NvbmZpcm1hdGlvbiIsIm9uU3VibWl0U3VjY2VzcyIsIm9uRXJyb3IiLCJnZlN1Ym1pc3Npb25VcmwiLCJzdWJzdHJpbmciLCJpbmRleE9mIiwiZmV0Y2giLCJtZXRob2QiLCJib2R5IiwidGhlbiIsInJlc3AiLCJqc29uIiwicmVzcG9uc2UiLCJpc192YWxpZCIsInJlcyIsImNvbmZpcm1hdGlvbk1lc3NhZ2UiLCJjb25maXJtYXRpb25fbWVzc2FnZSIsInR5cGUiLCJsaW5rIiwid2luZG93IiwibG9jYXRpb24iLCJyZXBsYWNlIiwic2Nyb2xsVG9Db25maXJtYXRpb24iLCJlcnJvciIsImVycm9yTWVzc2FnZXMiLCJ2YWxpZGF0aW9uX21lc3NhZ2VzIl0sInNvdXJjZXMiOlsiLi4vLi4vLi4vc3JjL0hlbHBlcnMvZm9ybS9vblN1Ym1pdEhhbmRsZXIuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IGZldGNoIGZyb20gXCJpc29tb3JwaGljLXVuZmV0Y2hcIjtcbmltcG9ydCB7IGZvcmNlVmFsaWRhdGlvbiwgc2Nyb2xsVG9Db25maXJtYXRpb24gfSBmcm9tIFwiLi9pbmRleFwiO1xuXG5hc3luYyBmdW5jdGlvbiBvblN1Ym1pdChcbiAgZXZlbnQsXG4gIHByb3BzLFxuICBmb3JtVmFsdWVzLFxuICBhY3RpdmVQYWdlLFxuICB3cmFwcGVyUmVmLFxuICBzZXRTdWJtaXR0aW5nLFxuICBzdWJtaXRTdWNjZXNzLFxuICBzZXRTdWJtaXRTdWNjZXNzLFxuICBzZXRTdWJtaXRGYWlsZWQsXG4gIHNldFNob3dQYWdlVmFsaWRhdGlvbk1zZyxcbiAgc2V0VG91Y2hlZCxcbiAgc2V0Q29uZmlybWF0aW9uTWVzc2FnZSxcbiAgc2V0RXJyb3JNZXNzYWdlc1xuKSB7XG4gIGNvbnN0IHsgb25TdWJtaXQ6IGN1c3RvbU9uU3VibWl0IH0gPSBwcm9wcztcbiAgY29uc3QgZm9ybURhdGEgPSBuZXcgRm9ybURhdGEoZXZlbnQudGFyZ2V0KTtcblxuICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gIGNvbnN0IGlzUGFnZVZhbGlkID0gZm9yY2VWYWxpZGF0aW9uKFxuICAgIGFjdGl2ZVBhZ2UsXG4gICAgZm9ybVZhbHVlcyxcbiAgICBzZXRTaG93UGFnZVZhbGlkYXRpb25Nc2csXG4gICAgc2V0VG91Y2hlZFxuICApO1xuICBpZiAoIWlzUGFnZVZhbGlkKSByZXR1cm4gZmFsc2U7XG5cbiAgaWYgKGN1c3RvbU9uU3VibWl0KSB7XG4gICAgY3VzdG9tT25TdWJtaXQoZm9ybURhdGEpO1xuICB9IGVsc2Uge1xuICAgIHNldFN1Ym1pdHRpbmcodHJ1ZSk7XG4gICAgc2V0U3VibWl0U3VjY2VzcyhmYWxzZSk7XG4gICAgc2V0U3VibWl0RmFpbGVkKGZhbHNlKTtcbiAgICBzZXRDb25maXJtYXRpb25NZXNzYWdlKGZhbHNlKTtcbiAgICBzZXRFcnJvck1lc3NhZ2VzKGZhbHNlKTtcblxuICAgIGNvbnN0IHsgZm9ybUlELCBiYWNrZW5kVXJsLCBqdW1wVG9Db25maXJtYXRpb24sIG9uU3VibWl0U3VjY2Vzcywgb25FcnJvciB9ID1cbiAgICAgIHByb3BzO1xuICAgIGNvbnN0IGdmU3VibWlzc2lvblVybCA9IGJhY2tlbmRVcmwuc3Vic3RyaW5nKFxuICAgICAgMCxcbiAgICAgIGJhY2tlbmRVcmwuaW5kZXhPZihcIi93cC1qc29uXCIpXG4gICAgKTtcblxuICAgIGZldGNoKGAke2dmU3VibWlzc2lvblVybH0vd3AtanNvbi9nZi92Mi9mb3Jtcy8ke2Zvcm1JRH0vc3VibWlzc2lvbnNgLCB7XG4gICAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgICAgYm9keTogZm9ybURhdGEsXG4gICAgfSlcbiAgICAgIC50aGVuKHJlc3AgPT4gcmVzcC5qc29uKCkpXG4gICAgICAudGhlbihyZXNwb25zZSA9PiB7XG4gICAgICAgIGlmIChyZXNwb25zZSAmJiByZXNwb25zZS5pc192YWxpZCkge1xuICAgICAgICAgIGlmIChvblN1Ym1pdFN1Y2Nlc3MpIHtcbiAgICAgICAgICAgIGNvbnN0IHJlcyA9IG9uU3VibWl0U3VjY2VzcyhyZXNwb25zZSk7XG4gICAgICAgICAgICBpZiAoIXJlcykge1xuICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICAgIGNvbnN0IGNvbmZpcm1hdGlvbk1lc3NhZ2UgPSByZXNwb25zZS5jb25maXJtYXRpb25fbWVzc2FnZTtcbiAgICAgICAgICBjb25zdCB7IHR5cGUsIGxpbmsgfSA9IGNvbmZpcm1hdGlvbk1lc3NhZ2UgfHwgZmFsc2U7XG4gICAgICAgICAgaWYgKHR5cGUgJiYgbGluayAmJiB0eXBlID09PSBcInJlZGlyZWN0XCIpIHtcbiAgICAgICAgICAgIGlmICh0eXBlb2Ygd2luZG93ICE9PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5yZXBsYWNlKGxpbmspO1xuICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICAgIHNldFN1Ym1pdHRpbmcoZmFsc2UpO1xuICAgICAgICAgIHNldFN1Ym1pdFN1Y2Nlc3ModHJ1ZSk7XG4gICAgICAgICAgc2V0Q29uZmlybWF0aW9uTWVzc2FnZShjb25maXJtYXRpb25NZXNzYWdlKTtcblxuICAgICAgICAgIGlmIChqdW1wVG9Db25maXJtYXRpb24pIHtcbiAgICAgICAgICAgIHNjcm9sbFRvQ29uZmlybWF0aW9uKHByb3BzLCB3cmFwcGVyUmVmKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGhyb3cge1xuICAgICAgICAgICAgcmVzcG9uc2UsXG4gICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgICAgfSlcbiAgICAgIC5jYXRjaChlcnJvciA9PiB7XG4gICAgICAgIGNvbnN0IGVycm9yTWVzc2FnZXMgPVxuICAgICAgICAgIGVycm9yICYmIGVycm9yLnJlc3BvbnNlICYmIGVycm9yLnJlc3BvbnNlLnZhbGlkYXRpb25fbWVzc2FnZXNcbiAgICAgICAgICAgID8gZXJyb3IucmVzcG9uc2UudmFsaWRhdGlvbl9tZXNzYWdlc1xuICAgICAgICAgICAgOiBcIlNvbWV0aGluZyB3ZW50IHdyb25nXCI7XG5cbiAgICAgICAgaWYgKG9uRXJyb3IpIHtcbiAgICAgICAgICBvbkVycm9yKGVycm9yTWVzc2FnZXMpO1xuICAgICAgICAgIHNldFN1Ym1pdHRpbmcoZmFsc2UpO1xuICAgICAgICAgIHNldFN1Ym1pdEZhaWxlZCh0cnVlKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBzZXRTdWJtaXR0aW5nKGZhbHNlKTtcbiAgICAgICAgICBzZXRTdWJtaXRGYWlsZWQodHJ1ZSk7XG4gICAgICAgICAgc2V0RXJyb3JNZXNzYWdlcyhlcnJvck1lc3NhZ2VzKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChqdW1wVG9Db25maXJtYXRpb24pIHtcbiAgICAgICAgICBzY3JvbGxUb0NvbmZpcm1hdGlvbihwcm9wcywgd3JhcHBlclJlZik7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IG9uU3VibWl0O1xuIl0sIm1hcHBpbmdzIjoieWNBR2VBLFNBQVEsK0lBQXZCLFdBQ0VDLENBQUssQ0FDTEMsQ0FBSyxDQUNMQyxDQUFVLENBQ1ZDLENBQVUsQ0FDVkMsQ0FBVSxDQUNWQyxDQUFhLENBQ2JDLENBQWEsQ0FDYkMsQ0FBZ0IsQ0FDaEJDLENBQWUsQ0FDZkMsQ0FBd0IsQ0FDeEJDLENBQVUsQ0FDVkMsQ0FBc0IsQ0FDdEJDLENBQWdCLCtHQUVFQyxDQUFjLENBQUtaLENBQUssQ0FBbENGLFFBQVEsQ0FDVmUsQ0FBUSxDQUFHLEdBQUlDLFNBQVEsQ0FBQ2YsQ0FBSyxDQUFDZ0IsTUFBTSxDQUFDLENBRTNDaEIsQ0FBSyxDQUFDaUIsY0FBYyxFQUFFLENBRWhCQyxDQUFXLENBQUcsR0FBQUMsc0JBQWUsRUFDakNoQixDQUFVLENBQ1ZELENBQVUsQ0FDVk8sQ0FBd0IsQ0FDeEJDLENBQVUsQ0FDWCxDQUNJUSxDQUFXLHFEQUVaTCxDQUFjLENBQ2hCQSxDQUFjLENBQUNDLENBQVEsQ0FBQyxFQUV4QlQsQ0FBYSxJQUFNLENBQ25CRSxDQUFnQixJQUFPLENBQ3ZCQyxDQUFlLElBQU8sQ0FDdEJHLENBQXNCLElBQU8sQ0FDN0JDLENBQWdCLElBQU8sQ0FFZlEsQ0FBTSxDQUNabkIsQ0FBSyxDQURDbUIsTUFBTSxDQUFFQyxDQUFVLENBQ3hCcEIsQ0FBSyxDQURTb0IsVUFBVSxDQUFFQyxDQUFrQixDQUM1Q3JCLENBQUssQ0FEcUJxQixrQkFBa0IsQ0FBRUMsQ0FBZSxDQUM3RHRCLENBQUssQ0FEeUNzQixlQUFlLENBQUVDLENBQU8sQ0FDdEV2QixDQUFLLENBRDBEdUIsT0FBTyxDQUVsRUMsQ0FBZSxDQUFHSixDQUFVLENBQUNLLFNBQVMsQ0FDMUMsQ0FBQyxDQUNETCxDQUFVLENBQUNNLE9BQU8sQ0FBQyxVQUFVLENBQUMsQ0FDL0IsQ0FFRCxHQUFBQyw2QkFBSyxZQUFJSCxDQUFlLGlDQUF3QkwsQ0FBTSxpQkFBZ0IsQ0FDcEVTLE1BQU0sQ0FBRSxNQUFNLENBQ2RDLElBQUksQ0FBRWhCLENBQ1IsQ0FBQyxDQUFDLENBQ0NpQixJQUFJLENBQUMsU0FBQUMsQ0FBSSxRQUFJQSxFQUFJLENBQUNDLElBQUksRUFBRSxFQUFDLENBQ3pCRixJQUFJLENBQUMsU0FBQUcsQ0FBUSxDQUFJLENBQ2hCLEdBQUlBLENBQVEsRUFBSUEsQ0FBUSxDQUFDQyxRQUFRLENBQUUsQ0FDakMsR0FBSVosQ0FBZSxDQUFFLENBQ25CLEdBQU1hLEVBQUcsQ0FBR2IsQ0FBZSxDQUFDVyxDQUFRLENBQUMsQ0FDckMsR0FBSSxDQUFDRSxDQUFHLENBQ04sUUFFSixDQUFDLEdBQ0tDLEVBQW1CLENBQUdILENBQVEsQ0FBQ0ksb0JBQW9CLEdBQ2xDRCxDQUFtQixJQUFTLENBQTNDRSxDQUFJLEdBQUpBLElBQUksQ0FBRUMsQ0FBSSxHQUFKQSxJQUFJLENBQ2xCLEdBQUlELENBQUksRUFBSUMsQ0FBSSxFQUFhLFVBQVUsR0FBbkJELENBQW1CLEVBQ2YsV0FBVyxFQUE3QixNQUFPRSxPQUFzQixDQUUvQixNQURBQSxPQUFNLENBQUNDLFFBQVEsQ0FBQ0MsT0FBTyxDQUFDSCxDQUFJLENBQUMsSUFJakNuQyxDQUFhLElBQU8sQ0FDcEJFLENBQWdCLElBQU0sQ0FDdEJJLENBQXNCLENBQUMwQixDQUFtQixDQUFDLENBRXZDZixDQUFrQixFQUNwQixHQUFBc0IsMkJBQW9CLEVBQUMzQyxDQUFLLENBQUVHLENBQVUsQ0FFMUMsQ0FBQyxJQUNDLE1BQU0sQ0FDSjhCLFFBQVEsQ0FBUkEsQ0FDRixDQUVKLENBQUMsQ0FBQyxTQUNJLENBQUMsU0FBQVcsQ0FBSyxDQUFJLENBQ2QsR0FBTUMsRUFBYSxDQUNqQkQsQ0FBSyxFQUFJQSxDQUFLLENBQUNYLFFBQVEsRUFBSVcsQ0FBSyxDQUFDWCxRQUFRLENBQUNhLG1CQUFtQixDQUN6REYsQ0FBSyxDQUFDWCxRQUFRLENBQUNhLG1CQUFtQixDQUNsQyxzQkFBc0IsQ0FFeEJ2QixDQUFPLEVBQ1RBLENBQU8sQ0FBQ3NCLENBQWEsQ0FBQyxDQUN0QnpDLENBQWEsSUFBTyxDQUNwQkcsQ0FBZSxJQUFNLEdBRXJCSCxDQUFhLElBQU8sQ0FDcEJHLENBQWUsSUFBTSxDQUNyQkksQ0FBZ0IsQ0FBQ2tDLENBQWEsQ0FBQyxFQUc3QnhCLENBQWtCLEVBQ3BCLEdBQUFzQiwyQkFBb0IsRUFBQzNDLENBQUssQ0FBRUcsQ0FBVSxDQUUxQyxDQUFDLENBQUMseUNBRVAsZ0RBRWNMLFFBQVEifQ==